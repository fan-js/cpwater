<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.ritac.mmbs.mybatis.mapper.DeviceFuctionMapper">
	<resultMap id="BaseResultMap"
		type="cn.ritac.mmbs.mybatis.model.DeviceFuction">
		<!-- WARNING - @mbg.generated -->
		<id column="id" jdbcType="INTEGER" property="id" />
		<result column="list_device" jdbcType="BIT"
			property="listDevice" />
		<result column="add_device" jdbcType="BIT" property="addDevice" />
		<result column="update_device" jdbcType="BIT"
			property="updateDevice" />
		<result column="del_device" jdbcType="BIT" property="delDevice" />
		<result column="param_device" jdbcType="BIT"
			property="paramDevice" />
		<result column="update_time" jdbcType="TIMESTAMP"
			property="updateTime" />
	</resultMap>

	<select id="findDeviceFunctionByRoleId" resultMap="BaseResultMap">
		SELECT
			df.*
		FROM mmbs_users  us
		LEFT JOIN mmbs_user_role ur ON  us.id = ur.user_id
		LEFT JOIN mmbs_admin ad ON ur.role_id = ad.id
		LEFT JOIN mmbs_role_admin ra  ON ad.id = ra.admin_id
		LEFT JOIN mmbs_role_device_fuction rdf ON ra.role_id = rdf.role_id
		LEFT JOIN mmbs_device_fuction df ON rdf.device_fuction_id = df.id
		WHERE 1=1
		AND us.telephone = #{phone}
		AND df.update_device = true
		GROUP BY df.id
	</select>
	
</mapper>