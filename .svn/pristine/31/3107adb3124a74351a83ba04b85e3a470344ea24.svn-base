package cn.ritac.mmbs.comm;

import java.util.Dictionary;
import java.util.Hashtable;
import java.util.Map;
import java.util.Random;

import com.yunpian.sdk.YunpianClient;
import com.yunpian.sdk.model.Result;
import com.yunpian.sdk.model.SmsSingleSend;

public class MessageGenerate {
	private static String _platformName = "【xxx】";

	private static Dictionary<MessageTemplateTypeEnum, String> _dicContent = new Hashtable<MessageTemplateTypeEnum, String>();

	static {
		_dicContent.put(MessageTemplateTypeEnum.RegisterTemplate, "您的验证码是{0}");
		_dicContent.put(MessageTemplateTypeEnum.ResetTemplate, "您的验证码是{0}");

	}

	public static String CreateRandom() {
		Random random = new Random();
		String result = "";
		for (int i = 0; i < 6; i++) {
			result += random.nextInt(10);
		}
		return result;

	}

	/**
	 * 发送短信
	 * 
	 * @param telephone
	 * @param code
	 * @param typeEnum
	 * @return
	 */
	public static Result<SmsSingleSend> SendMsg(String telephone, String code, MessageTemplateTypeEnum typeEnum) {

		YunpianClient clnt = new YunpianClient("apikey").init();

		// 发送短信API
		Map<String, String> param = clnt.newParam(2);
		param.put(YunpianClient.MOBILE, "18616020***");
		param.put(YunpianClient.TEXT, String.format(_platformName + _dicContent.get(typeEnum), code));
		Result<SmsSingleSend> r = clnt.sms().single_send(param);

		clnt.close();
		return r;

	}
}
