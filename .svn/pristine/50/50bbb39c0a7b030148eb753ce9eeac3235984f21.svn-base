<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="cn.ritac.mmbs.mybatis.mapper.AssetsFunctionMapper">
	<resultMap id="BaseResultMap"
		type="cn.ritac.mmbs.mybatis.model.AssetsFunction">
		<!-- WARNING - @mbg.generated -->
		<id column="id" jdbcType="INTEGER" property="id" />
		<result column="list_assets" jdbcType="BIT"
			property="listAssets" />
		<result column="add_assets" jdbcType="BIT" property="addAssets" />
		<result column="update_assets" jdbcType="BIT"
			property="updateAssets" />
		<result column="delete_assets" jdbcType="BIT"
			property="deleteAssets" />
		<result column="update_time" jdbcType="TIMESTAMP"
			property="updateTime" />
	</resultMap>

	<select id="findAssetsFunctionByRoleId"
		resultMap="BaseResultMap">
		SELECT
			df.*
		FROM mmbs_users  us
		LEFT JOIN mmbs_user_role ur ON  us.id = ur.user_id
		LEFT JOIN mmbs_admin ad ON ur.role_id = ad.id
		LEFT JOIN mmbs_role_admin ra  ON ad.id = ra.admin_id
		LEFT JOIN mmbs_role_assets_fuction rdf ON ra.role_id = rdf.role_id
		LEFT JOIN mmbs_assets_function df ON rdf.assets_function_id = df.id
		WHERE 1=1
		AND us.telephone = #{phone}
		AND df.update_assets = true
		GROUP BY df.id
	</select>
</mapper>